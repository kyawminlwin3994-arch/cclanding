<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BPL Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>

<body class="bg-gray-100 min-h-screen p-8">

    <div class="max-w-4xl mx-auto">
        <header class="flex justify-between items-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800">BPL Match Managers</h1>
            <a href="index.html" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition">View
                Site</a>
        </header>

        <!-- Hero Section Editor -->
        <div class="bg-indigo-50 border border-indigo-200 rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-xl font-bold text-indigo-800 mb-4">üèÜ Edit Hero Section</h2>
            <form id="heroForm" class="grid grid-cols-1 gap-4">
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1">Hero Title</label>
                    <input type="text" id="heroTitle" class="w-full border rounded p-2"
                        placeholder="e.g. BANGLADESH PREMIER LEAGUE">
                </div>

                <div class="border-t pt-2 mt-2">
                    <h3 class="font-bold text-gray-800 mb-2">üîñ Navbar Settings</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">Icon Class (<a
                                    href="https://fontawesome.com/search" target="_blank"
                                    class="text-blue-500 underline">FontAwesome</a>)</label>
                            <input type="text" id="navIconClass" class="w-full border rounded p-2"
                                placeholder="e.g. fa-solid fa-trophy">
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">Navbar Background Color</label>
                            <div class="flex gap-2">
                                <input type="color" id="navBackgroundColorPicker"
                                    class="h-10 w-10 border rounded cursor-pointer"
                                    onchange="document.getElementById('navBackgroundColor').value = this.value">
                                <input type="text" id="navBackgroundColor" class="w-full border rounded p-2"
                                    placeholder="#1e293b"
                                    oninput="document.getElementById('navBackgroundColorPicker').value = this.value">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">Navbar Title HTML</label>
                            <input type="text" id="navTitleHTML" class="w-full border rounded p-2"
                                placeholder="e.g. BPL<span class='text-green'>2026</span>">
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">Page Background Color</label>
                            <div class="flex gap-2">
                                <input type="color" id="bodyBackgroundColorPicker"
                                    class="h-10 w-10 border rounded cursor-pointer"
                                    onchange="document.getElementById('bodyBackgroundColor').value = this.value">
                                <input type="text" id="bodyBackgroundColor" class="w-full border rounded p-2"
                                    placeholder="#0f172a"
                                    oninput="document.getElementById('bodyBackgroundColorPicker').value = this.value">
                            </div>
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm font-bold text-gray-700 mb-1">Sign Up/Login Link (Live
                                Section)</label>
                            <input type="text" id="liveSectionLink" class="w-full border rounded p-2"
                                placeholder="https://...">
                        </div>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1">Promo Code</label>
                    <input type="text" id="promoCode" class="w-full border rounded p-2" placeholder="e.g. BPL2026">
                </div>


                <div class="border-t pt-2 mt-2">
                    <h3 class="font-bold text-gray-800 mb-2">üéÅ Bonus Section</h3>
                    <div class="mb-2">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Bonus Title</label>
                        <input type="text" id="bonusTitle" class="w-full border rounded p-2"
                            placeholder="e.g. üéÅ WELCOME BONUS">
                    </div>
                    <div class="mb-2">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Bonus Description (HTML
                            Allowed)</label>
                        <textarea id="bonusDesc" class="w-full border rounded p-2 h-20 text-xs font-mono"
                            placeholder="Deposit <span>...</span>"></textarea>
                    </div>
                    <div class="mb-2">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Button Text</label>
                        <input type="text" id="bonusButtonText" class="w-full border rounded p-2"
                            placeholder="e.g. CLAIM 100% BONUS NOW">
                    </div>
                    <div class="mb-2">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Button Link</label>
                        <input type="text" id="bonusButtonLink" class="w-full border rounded p-2"
                            placeholder="e.g. https://example.com">
                    </div>
                    <div class="mb-2">
                        <label class="block text-sm font-bold text-gray-700 mb-1">Bonus Gradient Colors</label>
                        <div class="grid grid-cols-2 gap-4 mt-1">
                            <div>
                                <label class="text-[10px] text-gray-500 block">Start Color</label>
                                <div class="flex gap-1">
                                    <input type="color" id="bonusGradientStartPicker"
                                        class="h-8 w-8 border rounded cursor-pointer"
                                        onchange="document.getElementById('bonusGradientStart').value = this.value">
                                    <input type="text" id="bonusGradientStart" class="w-full border rounded p-1 text-xs"
                                        placeholder="#064e3b"
                                        oninput="document.getElementById('bonusGradientStartPicker').value = this.value">
                                </div>
                            </div>
                            <div>
                                <label class="text-[10px] text-gray-500 block">End Color</label>
                                <div class="flex gap-1">
                                    <input type="color" id="bonusGradientEndPicker"
                                        class="h-8 w-8 border rounded cursor-pointer"
                                        onchange="document.getElementById('bonusGradientEnd').value = this.value">
                                    <input type="text" id="bonusGradientEnd" class="w-full border rounded p-1 text-xs"
                                        placeholder="#0f172a"
                                        oninput="document.getElementById('bonusGradientEndPicker').value = this.value">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mb-2">
                    <label class="block text-sm font-bold text-gray-700 mb-1">Bonus Colors</label>
                    <div class="grid grid-cols-2 gap-4 mt-1">
                        <div>
                            <label class="text-[10px] text-gray-500 block">Title Color</label>
                            <div class="flex gap-1">
                                <input type="color" id="bonusTitleColorPicker"
                                    class="h-8 w-8 border rounded cursor-pointer"
                                    onchange="document.getElementById('bonusTitleColor').value = this.value">
                                <input type="text" id="bonusTitleColor" class="w-full border rounded p-1 text-xs"
                                    placeholder="#ffffff"
                                    oninput="document.getElementById('bonusTitleColorPicker').value = this.value">
                            </div>
                        </div>
                        <div>
                            <label class="text-[10px] text-gray-500 block">Desc/Text Color</label>
                            <div class="flex gap-1">
                                <input type="color" id="bonusDescColorPicker"
                                    class="h-8 w-8 border rounded cursor-pointer"
                                    onchange="document.getElementById('bonusDescColor').value = this.value">
                                <input type="text" id="bonusDescColor" class="w-full border rounded p-1 text-xs"
                                    placeholder="#cbd5e1"
                                    oninput="document.getElementById('bonusDescColorPicker').value = this.value">
                            </div>
                        </div>
                        <div>
                            <label class="text-[10px] text-gray-500 block">Accent Color (Highlights)</label>
                            <div class="flex gap-1">
                                <input type="color" id="bonusAccentColorPicker"
                                    class="h-8 w-8 border rounded cursor-pointer"
                                    onchange="document.getElementById('bonusAccentColor').value = this.value">
                                <input type="text" id="bonusAccentColor" class="w-full border rounded p-1 text-xs"
                                    placeholder="#facc15"
                                    oninput="document.getElementById('bonusAccentColorPicker').value = this.value">
                            </div>
                        </div>
                        <div>
                            <label class="text-[10px] text-gray-500 block">Button Text Color</label>
                            <div class="flex gap-1">
                                <input type="color" id="bonusButtonTextColorPicker"
                                    class="h-8 w-8 border rounded cursor-pointer"
                                    onchange="document.getElementById('bonusButtonTextColor').value = this.value">
                                <input type="text" id="bonusButtonTextColor" class="w-full border rounded p-1 text-xs"
                                    placeholder="#000000"
                                    oninput="document.getElementById('bonusButtonTextColorPicker').value = this.value">
                            </div>
                        </div>
                        <div>
                            <label class="text-[10px] text-gray-500 block">Btn Gradient Start</label>
                            <div class="flex gap-1">
                                <input type="color" id="bonusButtonGradientStartPicker"
                                    class="h-8 w-8 border rounded cursor-pointer"
                                    onchange="document.getElementById('bonusButtonGradientStart').value = this.value">
                                <input type="text" id="bonusButtonGradientStart"
                                    class="w-full border rounded p-1 text-xs" placeholder="#F59E0B"
                                    oninput="document.getElementById('bonusButtonGradientStartPicker').value = this.value">
                            </div>
                        </div>
                        <div>
                            <label class="text-[10px] text-gray-500 block">Btn Gradient End</label>
                            <div class="flex gap-1">
                                <input type="color" id="bonusButtonGradientEndPicker"
                                    class="h-8 w-8 border rounded cursor-pointer"
                                    onchange="document.getElementById('bonusButtonGradientEnd').value = this.value">
                                <input type="text" id="bonusButtonGradientEnd" class="w-full border rounded p-1 text-xs"
                                    placeholder="#D97706"
                                    oninput="document.getElementById('bonusButtonGradientEndPicker').value = this.value">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="border-t pt-4 mt-2">
                    <h3 class="font-bold text-gray-800 mb-2">üì± Social Contact Links</h3>
                    <div id="socialContactsAdmin" class="space-y-4">
                        <!-- 3 slots for social contacts -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-2 p-3 bg-white border rounded shadow-sm">
                            <input type="text" id="social_0_name" class="border rounded p-2 text-xs"
                                placeholder="App Name">
                            <input type="text" id="social_0_link" class="border rounded p-2 text-xs"
                                placeholder="URL Link">
                            <input type="text" id="social_0_icon" class="border rounded p-2 text-xs"
                                placeholder="Icon Class">
                            <div class="flex gap-1 items-center">
                                <input type="color" id="social_0_colorPicker"
                                    class="h-8 w-8 border rounded cursor-pointer"
                                    onchange="document.getElementById('social_0_color').value = this.value">
                                <input type="text" id="social_0_color" class="w-full border rounded p-1 text-xs"
                                    placeholder="#ffffff"
                                    oninput="document.getElementById('social_0_colorPicker').value = this.value">
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-2 p-3 bg-white border rounded shadow-sm">
                            <input type="text" id="social_1_name" class="border rounded p-2 text-xs"
                                placeholder="App Name">
                            <input type="text" id="social_1_link" class="border rounded p-2 text-xs"
                                placeholder="URL Link">
                            <input type="text" id="social_1_icon" class="border rounded p-2 text-xs"
                                placeholder="Icon Class">
                            <div class="flex gap-1 items-center">
                                <input type="color" id="social_1_colorPicker"
                                    class="h-8 w-8 border rounded cursor-pointer"
                                    onchange="document.getElementById('social_1_color').value = this.value">
                                <input type="text" id="social_1_color" class="w-full border rounded p-1 text-xs"
                                    placeholder="#ffffff"
                                    oninput="document.getElementById('social_1_colorPicker').value = this.value">
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-2 p-3 bg-white border rounded shadow-sm">
                            <input type="text" id="social_2_name" class="border rounded p-2 text-xs"
                                placeholder="App Name">
                            <input type="text" id="social_2_link" class="border rounded p-2 text-xs"
                                placeholder="URL Link">
                            <input type="text" id="social_2_icon" class="border rounded p-2 text-xs"
                                placeholder="Icon Class">
                            <div class="flex gap-1 items-center">
                                <input type="color" id="social_2_colorPicker"
                                    class="h-8 w-8 border rounded cursor-pointer"
                                    onchange="document.getElementById('social_2_color').value = this.value">
                                <input type="text" id="social_2_color" class="w-full border rounded p-1 text-xs"
                                    placeholder="#ffffff"
                                    oninput="document.getElementById('social_2_colorPicker').value = this.value">
                            </div>
                        </div>
                    </div>
                </div>


                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1">Hero Image URL</label>
                    <input type="text" id="heroImage" class="w-full border rounded p-2" placeholder="Image URL"
                        oninput="document.getElementById('heroImagePreview').src = this.value; document.getElementById('heroImagePreview').classList.remove('hidden');">
                    <img id="heroImagePreview" src="" class="mt-2 h-32 object-cover rounded shadow hidden"
                        onerror="this.classList.add('hidden')">
                </div>
                <button type="submit"
                    class="bg-indigo-600 text-white font-bold py-2 px-4 rounded hover:bg-indigo-700 transition w-full md:w-auto">
                    Update Hero Section
                </button>
            </form>
        </div>

        <!-- Fetch Online Section -->
        <div class="bg-blue-50 border border-blue-200 rounded-lg shadow-md p-6 mb-8">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-blue-800">üåê Import from Online</h2>
                <div class="flex flex-col gap-4">
                    <!-- Live Feeds Row -->
                    <div class="flex flex-wrap items-center gap-2">
                        <span class="text-xs font-bold text-gray-500 uppercase tracking-widest mr-2">Live Feeds:</span>
                        <div class="flex bg-blue-100 p-1 rounded-lg gap-1">
                            <button onclick="fetchOnlineData('cricbuzz', 'live')"
                                class="bg-blue-600 text-white px-3 py-1.5 rounded text-xs hover:bg-blue-700 transition flex items-center gap-2">
                                <i class="fa-solid fa-tower-broadcast"></i> Live Now
                            </button>
                            <button onclick="fetchOnlineData('cricbuzz', 'upcoming')"
                                class="bg-blue-500 text-white px-3 py-1.5 rounded text-xs hover:bg-blue-600 transition flex items-center gap-2">
                                <i class="fa-solid fa-calendar-days"></i> Upcoming
                            </button>
                            <button onclick="fetchOnlineData('cricbuzz', 'recent')"
                                class="bg-blue-400 text-white px-3 py-1.5 rounded text-xs hover:bg-blue-500 transition flex items-center gap-2">
                                <i class="fa-solid fa-clock-rotate-left"></i> Finished
                            </button>
                        </div>
                        <button onclick="fetchOnlineData('sportradar')"
                            class="bg-purple-600 text-white px-4 py-2 rounded text-xs hover:bg-purple-700 transition flex items-center gap-2">
                            <i class="fa-solid fa-satellite-dish"></i> Sportradar
                        </button>
                    </div>

                    <!-- Date Picker Row -->
                    <div class="flex flex-wrap items-center gap-2">
                        <span class="text-xs font-bold text-gray-500 uppercase tracking-widest mr-2">Schedule by
                            Day:</span>
                        <div class="flex bg-indigo-100 p-1 rounded-lg gap-2 items-center">
                            <input type="date" id="fetchDatePicker"
                                class="px-2 py-1.5 text-xs rounded border border-indigo-200 focus:outline-none focus:ring-1 focus:ring-indigo-500">
                            <button onclick="fetchByDate()"
                                class="bg-indigo-600 text-white px-4 py-1.5 rounded text-xs hover:bg-indigo-700 transition flex items-center gap-2 font-bold">
                                <i class="fa-solid fa-magnifying-glass"></i> View Matches
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="onlineMatchesList" class="grid grid-cols-1 md:grid-cols-2 gap-4 empty:hidden">
                <!-- Fetched item -->
            </div>
            <p id="fetchStatus" class="text-sm text-gray-500 italic mt-2 hidden">Fetching data...</p>
        </div>

        <!-- Add/Edit Form -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-xl font-bold mb-4 border-b pb-2">Add / Edit Match</h2>
            <form id="matchForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <input type="hidden" id="matchId">

                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1">Series Name</label>
                    <input type="text" id="series" class="w-full border rounded p-2" value="BPL 2026">
                </div>

                <div class="grid grid-cols-2 gap-2">
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-1">Date</label>
                        <input type="text" id="date" class="w-full border rounded p-2" placeholder="Today / 06 Feb">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-1">Time</label>
                        <input type="text" id="time" class="w-full border rounded p-2" placeholder="19:00 PM">
                    </div>
                </div>

                <div class="md:col-span-2">
                    <label class="block text-sm font-bold text-gray-700 mb-1">Venue</label>
                    <input type="text" id="venue" class="w-full border rounded p-2" placeholder="Dhaka Stadium">
                </div>

                <!-- Team 1 -->
                <div class="bg-gray-50 p-3 rounded">
                    <h3 class="font-bold text-blue-600 mb-2">Team 1 (Left)</h3>
                    <input type="text" id="team1Name" placeholder="Name (e.g. Dhaka Dominators)"
                        class="w-full border rounded p-2 mb-2">
                    <input type="text" id="team1Logo" placeholder="Logo URL" class="w-full border rounded p-2 mb-2">
                    <input type="text" id="team1Odds" placeholder="Odds (e.g. 1.95)" class="w-full border rounded p-2">
                </div>

                <!-- Team 2 -->
                <div class="bg-gray-50 p-3 rounded">
                    <h3 class="font-bold text-blue-600 mb-2">Team 2 (Right)</h3>
                    <input type="text" id="team2Name" placeholder="Name (e.g. Comilla Victorians)"
                        class="w-full border rounded p-2 mb-2">
                    <input type="text" id="team2Logo" placeholder="Logo URL" class="w-full border rounded p-2 mb-2">
                    <input type="text" id="team2Odds" placeholder="Odds (e.g. 1.85)" class="w-full border rounded p-2">
                </div>

                <div class="md:col-span-2 flex items-center gap-2">
                    <input type="checkbox" id="isLive" class="w-5 h-5">
                    <label for="isLive" class="font-bold text-red-600">Is this match LIVE now?</label>
                </div>

                <div class="md:col-span-2 mt-4">
                    <button type="submit"
                        class="w-full bg-green-600 text-white font-bold py-3 rounded hover:bg-green-700 transition">Save
                        Match Card</button>
                    <button type="button" onclick="resetForm()"
                        class="w-full mt-2 text-gray-500 underline text-sm">Clear
                        Form</button>
                </div>
            </form>
        </div>

        <!-- Match List -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-bold mb-4">Active Matches</h2>
            <div id="matchesList" class="space-y-4">
                <!-- Matches injected here -->
            </div>
        </div>
    </div>

    <script>
        const API_URL = '/api/matches';

        let globalMatches = [];

        // Load Matches
        async function loadMatches() {
            try {
                const res = await fetch(API_URL);
                globalMatches = await res.json();
                const list = document.getElementById('matchesList');
                list.innerHTML = '';

                globalMatches.forEach(m => {
                    // Safe handling of data
                    list.innerHTML += `
                        <div class="border rounded p-4 flex justify-between items-center hover:bg-gray-50 transition">
                            <div class="flex items-center gap-4">
                                <div class="text-center">
                                    <img src="${m.team1.logo || '#'}" class="w-10 h-10 object-contain mx-auto" onerror="this.src='https://placehold.co/40x40?text=T1'">
                                    <span class="text-xs font-bold block mt-1">${m.team1.name}</span>
                                </div>
                                <span class="font-bold text-gray-400 text-xl">VS</span>
                                <div class="text-center">
                                    <img src="${m.team2.logo || '#'}" class="w-10 h-10 object-contain mx-auto" onerror="this.src='https://placehold.co/40x40?text=T2'">
                                    <span class="text-xs font-bold block mt-1">${m.team2.name}</span>
                                </div>
                                <div class="ml-4 border-l pl-4">
                                    <div class="text-xs text-gray-500">${m.date} @ ${m.time}</div>
                                    <div class="text-xs font-bold ${m.isLive ? 'text-red-500 animate-pulse' : 'text-gray-400'}">
                                        ${m.isLive ? 'üî¥ LIVE' : 'UPCOMING'}
                                    </div>
                                </div>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="triggerEdit('${m.id}')" class="bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600">Edit</button>
                                <button onclick="deleteMatch('${m.id}')" class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600">Delete</button>
                            </div>
                        </div>
                    `;
                });
            } catch (err) {
                console.error("Error loading matches:", err);
            }
        }

        function triggerEdit(id) {
            const m = globalMatches.find(x => x.id === id);
            if (m) editMatch(m);
        }

        // Add / Update
        document.getElementById('matchForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const matchData = {
                id: document.getElementById('matchId').value || null,
                series: document.getElementById('series').value,
                date: document.getElementById('date').value,
                time: document.getElementById('time').value,
                venue: document.getElementById('venue').value,
                isLive: document.getElementById('isLive').checked,
                team1: {
                    name: document.getElementById('team1Name').value,
                    logo: document.getElementById('team1Logo').value,
                    odds: document.getElementById('team1Odds').value,
                },
                team2: {
                    name: document.getElementById('team2Name').value,
                    logo: document.getElementById('team2Logo').value,
                    odds: document.getElementById('team2Odds').value,
                }
            };

            await fetch(API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(matchData)
            });

            resetForm();
            loadMatches();
        });

        // Delete
        async function deleteMatch(id) {
            if (!confirm('Are you sure you want to delete this match?')) return;
            await fetch(`${API_URL}/${id}`, { method: 'DELETE' });
            loadMatches();
        }

        // Edit Helper
        function editMatch(m) {
            document.getElementById('matchId').value = m.id;
            document.getElementById('series').value = m.series;
            document.getElementById('date').value = m.date;
            document.getElementById('time').value = m.time;
            document.getElementById('venue').value = m.venue;
            document.getElementById('isLive').checked = m.isLive;

            document.getElementById('team1Name').value = m.team1.name;
            document.getElementById('team1Logo').value = m.team1.logo;
            document.getElementById('team1Odds').value = m.team1.odds;

            document.getElementById('team2Name').value = m.team2.name;
            document.getElementById('team2Logo').value = m.team2.logo;
            document.getElementById('team2Odds').value = m.team2.odds;

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function resetForm() {
            document.getElementById('matchForm').reset();
            document.getElementById('matchId').value = '';
        }

        let fetchedOnlineMatches = [];

        window.onload = () => {
            loadMatches();
            // Set default date picker to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('fetchDatePicker').value = today;
        };

        // Fetch by Specific Date
        function fetchByDate() {
            const date = document.getElementById('fetchDatePicker').value;
            if (!date) return alert("Please select a date");
            fetchOnlineData('cricbuzz', `schedule&date=${date}`);
        }

        // Fetch Online Data
        async function fetchOnlineData(source = 'cricbuzz', type = 'live') {
            const status = document.getElementById('fetchStatus');
            const list = document.getElementById('onlineMatchesList');

            const isDateSearch = type.includes('date=');
            const sourceName = source === 'sportradar' ? 'Sportradar' : (isDateSearch ? 'Cricbuzz Schedule' : `Cricbuzz (${type.toUpperCase()})`);
            let endpoint = source === 'sportradar' ? '/api/fetch-sportradar' : `/api/fetch-online?type=${type}`;

            status.textContent = `Fetching ${isDateSearch ? 'matches for selected date' : type} data from ${sourceName}... please wait...`;
            status.classList.remove('hidden');
            list.innerHTML = '';

            try {
                const res = await fetch(endpoint);
                const data = await res.json();

                if (data.success && data.matches.length > 0) {
                    fetchedOnlineMatches = data.matches; // Store globally
                    status.classList.add('hidden');

                    fetchedOnlineMatches.forEach((m, index) => {
                        list.innerHTML += `
                            <div class="bg-white p-3 rounded border border-blue-100 shadow-sm flex flex-col justify-between">
                                <div>
                                    <div class="text-[10px] bg-blue-100 text-blue-600 inline-block px-1 rounded mb-1">${m.series}</div>
                                    <div class="flex items-center gap-2 mb-2">
                                        <div class="flex items-center gap-1 flex-1">
                                            <img src="${m.team1.logo}" class="w-6 h-6 object-contain" onerror="this.src='https://placehold.co/24x24?text=T1'">
                                            <span class="font-bold text-xs truncate">${m.team1.name}</span>
                                        </div>
                                        <span class="text-gray-400 text-[10px]">vs</span>
                                        <div class="flex items-center gap-1 flex-1 text-right">
                                            <span class="font-bold text-xs truncate">${m.team2.name}</span>
                                            <img src="${m.team2.logo}" class="w-6 h-6 object-contain" onerror="this.src='https://placehold.co/24x24?text=T2'">
                                        </div>
                                    </div>
                                    <div class="text-[10px] text-gray-500 mt-1">${m.status || 'Live'}</div>
                                </div>
                                <button onclick="triggerImport(${index})" class="mt-3 w-full bg-green-500 hover:bg-green-600 text-white text-xs font-bold py-2 rounded">
                                    <i class="fa-solid fa-plus mr-1"></i> Add to List
                                </button>
                            </div>
                        `;
                    });
                } else {
                    status.textContent = `No live matches found from ${sourceName}.`;
                }
            } catch (err) {
                console.error(err);
                status.textContent = "Error fetching data. Ensure server is running.";
            }
        }

        function triggerImport(index) {
            const m = fetchedOnlineMatches[index];
            if (m) importMatch(m);
        }

        // Import Match to Form (or directly save)
        function importMatch(m) {
            // Auto-fill the form with fetched data
            document.getElementById('series').value = m.series;
            document.getElementById('date').value = m.date || ''; // Populate Date
            document.getElementById('time').value = m.time || ''; // Populate Time
            document.getElementById('team1Name').value = m.team1.name;
            document.getElementById('team1Logo').value = m.team1.logo; // Populate logo
            document.getElementById('team2Name').value = m.team2.name;
            document.getElementById('team2Logo').value = m.team2.logo; // Populate logo
            document.getElementById('isLive').checked = m.isLive;

            // Scroll to form
            document.getElementById('matchForm').scrollIntoView({ behavior: 'smooth' });
            alert(`Imported: ${m.team1.name} vs ${m.team2.name}\nPlease review the logos/odds and click 'Save Match Card'.`);
        }

        // Default Date Picker Logic
        window.onload = () => {
            loadMatches();
            loadHeroData();
            // Set default date picker to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('fetchDatePicker').value = today;
        };

        // Hero Data Logic
        async function loadHeroData() {
            try {
                const res = await fetch('/api/hero');
                const data = await res.json();
                if (data) {
                    document.getElementById('heroTitle').value = data.title || '';
                    document.getElementById('navIconClass').value = data.navIconClass || '';

                    document.getElementById('navTitleHTML').value = data.navTitleHTML || '';
                    document.getElementById('navBackgroundColor').value = data.navBackgroundColor || '#1e293b';
                    document.getElementById('navBackgroundColorPicker').value = data.navBackgroundColor || '#1e293b';
                    document.getElementById('bodyBackgroundColor').value = data.bodyBackgroundColor || '#0f172a';
                    document.getElementById('bodyBackgroundColorPicker').value = data.bodyBackgroundColor || '#0f172a';
                    document.getElementById('liveSectionLink').value = data.liveSectionLink || '';
                    document.getElementById('promoCode').value = data.promoCode || '';
                    document.getElementById('bonusTitle').value = data.bonusTitle || '';
                    document.getElementById('bonusDesc').value = data.bonusDesc || '';
                    document.getElementById('bonusButtonText').value = data.bonusButtonText || '';
                    document.getElementById('bonusButtonLink').value = data.bonusButtonLink || '';
                    document.getElementById('bonusGradientStart').value = data.bonusGradientStart || '#064e3b';
                    document.getElementById('bonusGradientStartPicker').value = data.bonusGradientStart || '#064e3b';
                    document.getElementById('bonusGradientEnd').value = data.bonusGradientEnd || '#0f172a';
                    document.getElementById('bonusGradientEndPicker').value = data.bonusGradientEnd || '#0f172a';

                    document.getElementById('bonusTitleColor').value = data.bonusTitleColor || '#ffffff';
                    document.getElementById('bonusTitleColorPicker').value = data.bonusTitleColor || '#ffffff';
                    document.getElementById('bonusDescColor').value = data.bonusDescColor || '#cbd5e1';
                    document.getElementById('bonusDescColorPicker').value = data.bonusDescColor || '#cbd5e1';
                    document.getElementById('bonusAccentColor').value = data.bonusAccentColor || '#facc15';
                    document.getElementById('bonusAccentColorPicker').value = data.bonusAccentColor || '#facc15';
                    document.getElementById('bonusButtonTextColor').value = data.bonusButtonTextColor || '#000000';
                    document.getElementById('bonusButtonTextColorPicker').value = data.bonusButtonTextColor || '#000000';
                    document.getElementById('bonusButtonGradientStart').value = data.bonusButtonGradientStart || '#F59E0B';
                    document.getElementById('bonusButtonGradientStartPicker').value = data.bonusButtonGradientStart || '#F59E0B';
                    document.getElementById('bonusButtonGradientEnd').value = data.bonusButtonGradientEnd || '#D97706';
                    document.getElementById('bonusButtonGradientEndPicker').value = data.bonusButtonGradientEnd || '#D97706';

                    if (data.socialContacts && data.socialContacts.length > 0) {
                        data.socialContacts.forEach((sc, i) => {
                            if (i < 3) {
                                document.getElementById(`social_${i}_name`).value = sc.name || '';
                                document.getElementById(`social_${i}_link`).value = sc.link || '';
                                document.getElementById(`social_${i}_icon`).value = sc.icon || '';
                                document.getElementById(`social_${i}_color`).value = sc.color || '#ffffff';
                                document.getElementById(`social_${i}_colorPicker`).value = sc.color || '#ffffff';
                            }
                        });
                    }
                    document.getElementById('heroImage').value = data.imageUrl || '';
                    if (data.imageUrl) {
                        const preview = document.getElementById('heroImagePreview');
                        preview.src = data.imageUrl;
                        preview.classList.remove('hidden');
                    }
                }
            } catch (err) {
                console.error("Error loading hero data:", err);
            }
        }

        document.getElementById('heroForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = {
                title: document.getElementById('heroTitle').value,
                navIconClass: document.getElementById('navIconClass').value,

                navTitleHTML: document.getElementById('navTitleHTML').value,
                navBackgroundColor: document.getElementById('navBackgroundColor').value,
                bodyBackgroundColor: document.getElementById('bodyBackgroundColor').value,
                liveSectionLink: document.getElementById('liveSectionLink').value,
                promoCode: document.getElementById('promoCode').value,
                bonusTitle: document.getElementById('bonusTitle').value,
                bonusDesc: document.getElementById('bonusDesc').value,
                bonusButtonText: document.getElementById('bonusButtonText').value,
                bonusButtonLink: document.getElementById('bonusButtonLink').value,
                bonusGradientStart: document.getElementById('bonusGradientStart').value,
                bonusGradientEnd: document.getElementById('bonusGradientEnd').value,
                bonusTitleColor: document.getElementById('bonusTitleColor').value,
                bonusDescColor: document.getElementById('bonusDescColor').value,
                bonusAccentColor: document.getElementById('bonusAccentColor').value,
                bonusButtonTextColor: document.getElementById('bonusButtonTextColor').value,
                bonusButtonGradientStart: document.getElementById('bonusButtonGradientStart').value,
                bonusButtonGradientEnd: document.getElementById('bonusButtonGradientEnd').value,
                socialContacts: [
                    {
                        name: document.getElementById('social_0_name').value,
                        link: document.getElementById('social_0_link').value,
                        icon: document.getElementById('social_0_icon').value,
                        color: document.getElementById('social_0_color').value
                    },
                    {
                        name: document.getElementById('social_1_name').value,
                        link: document.getElementById('social_1_link').value,
                        icon: document.getElementById('social_1_icon').value,
                        color: document.getElementById('social_1_color').value
                    },
                    {
                        name: document.getElementById('social_2_name').value,
                        link: document.getElementById('social_2_link').value,
                        icon: document.getElementById('social_2_icon').value,
                        color: document.getElementById('social_2_color').value
                    }
                ],
                imageUrl: document.getElementById('heroImage').value
            };

            try {
                await fetch('/api/hero', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                alert('Hero section updated successfully!');
            } catch (err) {
                alert('Failed to update hero section');
                console.error(err);
            }
        });
    </script>
</body>

</html>